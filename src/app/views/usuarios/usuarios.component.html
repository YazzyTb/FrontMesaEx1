<div class="mb-4 grid grid-cols-1 gap-6 xl:grid-cols-3">
    <div
        class="relative flex flex-col bg-clip-border rounded-xl bg-white text-gray-700 shadow-md overflow-hidden xl:col-span-2">
        <div
            class="relative bg-clip-border rounded-xl overflow-hidden bg-transparent text-gray-700 shadow-none m-0 flex items-center justify-between p-6">
            <div>
                <h2
                    class="block antialiased tracking-normal font-sans text-base font-bold leading-relaxed text-blue-gray-900 mb-1">
                    Usuarios</h2>

            </div>
        </div>
        <div class="p-6 overflow-x-scroll px-0 pt-0 pb-2">

            <table class="w-full min-w-[640px] table-auto">
                <thead>
                    <tr>
                        <th class="border-b border-blue-gray-50 py-3 px-6 text-left">
                            <p class="block antialiased font-sans text-[11px] font-medium uppercase text-blue-gray-400">
                                ID</p>
                        </th>
                        <th class="border-b border-blue-gray-50 py-3 px-6 text-left">
                            <p class="block antialiased font-sans text-[11px] font-medium uppercase text-blue-gray-400">
                                Nombre Completo</p>
                        </th>
                        <th class="border-b border-blue-gray-50 py-3 px-6 text-left">
                            <p class="block antialiased font-sans text-[11px] font-medium uppercase text-blue-gray-400">
                                E-mail</p>
                        </th>
                        <th class="border-b border-blue-gray-50 py-3 px-6 text-left">
                            <p class="block antialiased font-sans text-[11px] font-medium uppercase text-blue-gray-400">
                                Teléfono</p>
                        </th>
                        <th class="border-b border-blue-gray-50 py-3 px-6 text-left">
                            <p class="block antialiased font-sans text-[11px] font-medium uppercase text-blue-gray-400">
                                Dirección</p>
                        </th>
                        <th class="border-b border-blue-gray-50 py-3 px-6 text-left">
                            <p class="block antialiased font-sans text-[11px] font-medium uppercase text-blue-gray-400">
                                Rol</p>
                        </th>
                        <th class="border-b border-blue-gray-50 py-3 px-6 text-left">
                            <p class="block antialiased font-sans text-[11px] font-medium uppercase text-blue-gray-400">
                                Acción</p>
                        </th>
                    </tr>
                </thead>

                <tbody>
                    <tr *ngFor="let user of users">
                        <td class="py-3 px-5 border-b border-blue-gray-50">
                            <p class="block antialiased font-sans text-xs font-medium text-blue-gray-600">{{ user.id }}
                            </p>
                        </td>
                        <td class="py-3 px-5 border-b border-blue-gray-50">
                            <p class="block antialiased font-sans text-xs font-medium text-blue-gray-600">{{
                                user.nombre_completo }}</p>
                        </td>
                        <td class="py-3 px-5 border-b border-blue-gray-50">
                            <p class="block antialiased font-sans text-xs font-medium text-blue-gray-600">{{
                                user.email}}</p>
                        </td>
                        <td class="py-3 px-5 border-b border-blue-gray-50">
                            <p class="block antialiased font-sans text-xs font-medium text-blue-gray-600">{{
                                user.telefono}}</p>
                        </td>
                        <td class="py-3 px-5 border-b border-blue-gray-50">
                            <p class="block antialiased font-sans text-xs font-medium text-blue-gray-600">{{
                                user.direccion}}</p>
                        </td>
                        <td class="py-3 px-5 border-b border-blue-gray-50">
                            <p class="block antialiased font-sans text-xs font-medium text-blue-gray-600">{{
                                rolesMap[user.rol] || 'Sin rol'}}</p>
                        </td>
                        <td class="py-3 px-5 border-b border-blue-gray-50">
                            <svg (click)="openModalToUpdateUser(user)" xmlns="http://www.w3.org/2000/svg" height="24px"
                                viewBox="0 -960 960 960" width="24px" fill="#008080">
                                <path
                                    d="M560-120v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q8 9 12.5 20t4.5 22q0 11-4 22.5T903-340L683-120H560Zm-400-40v-112q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q37 0 73 4.5t72 14.5L480-276v116H160Zm663-184 37-39-37-37-38 38 38 38ZM480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47Z" />
                            </svg>
                            <svg (click)="deleteUser(user)" xmlns="http://www.w3.org/2000/svg" height="24px"
                                viewBox="0 -960 960 960" width="24px" fill="#dc4340">
                                <path
                                    d="m696-440-56-56 83-84-83-83 56-57 84 84 83-84 57 57-84 83 84 84-57 56-83-83-84 83Zm-336-40q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM40-160v-112q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q66 0 130 15.5T616-378q29 15 46.5 43.5T680-272v112H40Z" />
                            </svg>
                        </td>
                    </tr>
                </tbody>

            </table>
            <!-- BOTON PARA REGISTRAR UN NUEVO USUARIO -->
            <button (click)="activeRegisterForm()" type="button"
                class="appearance-none block bg-blue-700 text-gray-100 font-bold border border-gray-200 rounded-lg py-3 px-3 leading-tight hover:bg-blue-600 focus:outline-none focus:bg-white focus:border-gray-500">Agregar
                Usuario</button>

        </div>
    </div>
</div>
<!-- VENTANA EMERGENTE PARA REGISTRAR A UN NUEVO USUARIO -->
<div *ngIf="isModalRegisterUserOpen"
    class="fixed inset-0 bg-gray-600 bg-opacity-50 flex justify-center items-center z-50">
    <div class="bg-white rounded-lg shadow-lg w-11/12 sm:w-96 p-6">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-blue-gray-900">Registrar Usuario</h2>
            <button (click)="closeRegisterUserModal()" id="closeModalBtn"
                class="text-gray-600 text-2xl font-semibold hover:text-gray-900">&times;</button>
        </div>

        <form (submit)="registerUser()" class="space-y-4">

            <div>
                <label for="username" class="block text-sm font-medium text-gray-700">Nombre Completo</label>
                <input type="text" id="username" [(ngModel)]="username" name="username"
                    class="w-full mt-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                    required />
            </div>

            <div>
                <label for="password" class="block text-sm font-medium text-gray-700">Contraseña</label>
                <input type="password" id="password" [(ngModel)]="password" name="password"
                    class="w-full mt-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                    required />
            </div>

            <div>
                <label for="email" class="block text-sm font-medium text-gray-700">E-mail</label>
                <input type="email" id="email" [(ngModel)]="email" name="email"
                    class="w-full mt-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                    required />
            </div>

            <div>
                <label for="telefono" class="block text-sm font-medium text-gray-700">Teléfono</label>
                <input type="text" id="telefono" [(ngModel)]="telefono" name="telefono"
                    class="w-full mt-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                    required minlength="8" maxlength="8" />
            </div>

            <div>
                <label for="direccion" class="block text-sm font-medium text-gray-700">Dirección</label>
                <input type="text" id="direccion" [(ngModel)]="direccion" name="direccion"
                    class="w-full mt-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                    required />
            </div>

            <div>
                <label for="role" class="block text-sm font-medium text-gray-700">Rol</label>
                <select id="role" [(ngModel)]="selectedRole" name="role"
                    class="w-full mt-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                    required>
                    <option value="" disabled selected>Seleccione un role</option>
                    <option *ngFor="let role of roles" [value]="role.id">{{ role.nombre }}</option>
                </select>
            </div>

            <div class="flex justify-between mt-6">
                <button (click)="closeRegisterUserModal()" type="button" id="closeModalBtn"
                    class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 focus:outline-none">Cancelar</button>
                <button type="submit"
                    class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-500 focus:outline-none">Registrar</button>
            </div>
        </form>
    </div>
</div>
<!-- VENTANA EMERGENTE PARA ACTUALIZAR LOS DATOS DE UN USUARIO -->
<div *ngIf="isModalUpdateUserOpen"
    class="fixed inset-0 bg-gray-600 bg-opacity-50 flex justify-center items-center z-50">
    <div class="bg-white rounded-lg shadow-lg w-11/12 sm:w-96 p-6">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-blue-gray-900">Actualizar Usuario</h2>
            <button (click)="closeUpdateUserModal()" id="closeModalBtn"
                class="text-gray-600 text-2xl font-semibold hover:text-gray-900">&times;</button>
        </div>

        <form (submit)="updateUser()" class="space-y-4">

            <div>
                <label for="username" class="block text-sm font-medium text-gray-700">Nombre Completo</label>
                <input type="text" id="usernameUpdate" [(ngModel)]="usernameUpdate" name="usernameUpdate"
                    class="w-full mt-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                    required minlength="4" />
            </div>

            <div>
                <label for="passwordUpdate" class="block text-sm font-medium text-gray-700">Contraseña</label>
                <input type="password" id="passwordUpdate" [(ngModel)]="passwordUpdate" name="passwordUpdate"
                    class="w-full mt-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                    required />
            </div>

            <div>
                <label for="email" class="block text-sm font-medium text-gray-700">E-mail</label>
                <input type="email" id="emailUpdate" [(ngModel)]="emailUpdate" name="emailUpdate"
                    class="w-full mt-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                    required minlength="4" />
            </div>

            <div>
                <label for="telefono" class="block text-sm font-medium text-gray-700">Teléfono</label>
                <input type="text" id="telefonoUpdate" [(ngModel)]="telefonoUpdate" name="telefonoUpdate"
                    class="w-full mt-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                    required minlength="8" maxlength="8" />
            </div>

            <div>
                <label for="direccion" class="block text-sm font-medium text-gray-700">Dirección</label>
                <input type="text" id="direccionUpdate" [(ngModel)]="direccionUpdate" name="direccionUpdate"
                    class="w-full mt-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                    required minlength="4" />
            </div>

            <div>
                <label for="roleUpdate" class="block text-sm font-medium text-gray-700">Rol</label>
                <select id="roleUpdate" [(ngModel)]="roleUpdate" (ngModelChange)="updateRoleId($event)"
                    name="roleUpdate"
                    class="w-full mt-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                    required>
                    <option *ngFor="let role of roles" [value]="role.id">{{ role.nombre }}</option>
                </select>
            </div>

            <div class="flex justify-between mt-6">
                <button (click)="closeUpdateUserModal()" type="button" id="closeModalBtn"
                    class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 focus:outline-none">Cancelar</button>
                <button type="submit"
                    class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-500 focus:outline-none">Actualizar</button>
            </div>
        </form>
    </div>
</div>